#////////////////////////////////////////////////////////////////////////////// 
# Start SSMS 
#////////////////////////////////////////////////////////////////////////////// 
function Start-MeSsms 
{ 
    param([Object]$db) 
    Ssms -E -S "(LocalDB)\$db" -nosplash   
} 

#////////////////////////////////////////////////////////////////////////////// 
# Get LocalDB Info 
#////////////////////////////////////////////////////////////////////////////// 
function Get-LocalDbInfo
{ 
    sqllocaldb i 
}

#////////////////////////////////////////////////////////////////////////////// 
# Remove LocalDB 
#////////////////////////////////////////////////////////////////////////////// 
function Remove-LocalDb 
{ 
    Param( [string]$Name ) 
     
    if ($Name) 
    { 
      sqllocaldb p $Name 
      sqllocaldb d $Name 
    }  
}

#////////////////////////////////////////////////////////////////////////////// 
# New LocalDB 
#////////////////////////////////////////////////////////////////////////////// 
function New-LocalDb 
{ 
    Param( [string]$Name ) 

    sqllocaldb c $Name -s 
}

#////////////////////////////////////////////////////////////////////////////// 
# Initialize LocalDB 
#////////////////////////////////////////////////////////////////////////////// 
function Initialize-LocalDb 
{ 
    Param( 
        [string]$prev, 
        [string]$curr 
    ) 
    # Make sure that previous database is cleaned up 
    Remove-LocalDb $prev

    # Remove and create the new one
    Remove-LocalDb $curr
    New-LocalDb $curr
}

